<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Steal a Brainrot - Unblocked</title>
    <style>
        body { margin: 0; background: #000; overflow: hidden; display: flex; justify-content: center; align-items: center; height: 100vh; }
        #unity-canvas { width: 100%; height: 100%; background: #000; }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/coi-serviceworker/0.1.7/coi-serviceworker.min.js"></script>

    <script>
        // 1. STUBBING: This is the specific fix for the 'push' error.
        // We define the arrays on the window so the framework script (8b2e24a...) can find them.
        window.deinitializers = [];
        window.preRun = [];
        window.postRun = [];

        // 2. MODULE DEFINITION: Defining the Module before the loader script is fetched.
        var Module = {
            preRun: window.preRun,
            postRun: window.postRun,
            deinitializers: window.deinitializers,
            canvas: document.querySelector("#unity-canvas"),
            print: function(text) { console.log(text); },
            setStatus: function(text) { console.log(text); }
        };

        // 3. SDK BYPASS
        window.ysdk = {
            features: { LoadingAPI: { ready: () => {} }, GameplayAPI: { start: () => {}, stop: () => {} } },
            adv: { showFullscreenAdv: (opts) => { if(opts.callbacks) opts.callbacks.onClose(true); } }
        };
    </script>
</head>
<body>
    <canvas id="unity-canvas"></canvas>

    <script src="build/StealBrainrot.loader.js"></script>
    
    <script>
        const canvas = document.querySelector("#unity-canvas");
        
        // This function call is what the StealBrainrot.loader.js provides
        createUnityInstance(canvas, {
            dataUrl: "build/data.data",
            frameworkUrl: "build/8b2e24a34eb309de7efc1aeb6e648233.js",
            codeUrl: "build/code.wasm",
            streamingAssetsUrl: "StreamingAssets",
            companyName: "DefaultCompany",
            productName: "Steal a Brainrot",
            productVersion: "1.0",
            
            // Feeding the stubbed arrays into the config
            deinitializers: window.deinitializers,
            preRun: window.preRun,
            postRun: window.postRun,

            cacheControl: (url) => "no-store",
            decompressor: "br" 
        }).then((unityInstance) => {
            console.log("Unity loaded and push error bypassed!");
        }).catch((err) => {
            console.error("Unity failed to load:", err);
        });
    </script>
</body>
</html>